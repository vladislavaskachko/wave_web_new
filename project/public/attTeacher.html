<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£—á–µ—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</title>
    <style>
        /* –ë–ª–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É */
        .top-right-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

            .top-right-menu button {
                width: 50px;
                height: 50px;
                border: none;
                border-radius: 50%;
                background-color: #002F6C;
                color: white;
                cursor: pointer;
                font-size: 24px;
                text-align: center;
            }
    </style>
</head>
<body>
    <!-- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–ª–æ–∫ –∫–Ω–æ–ø–æ–∫ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
    <div class="top-right-menu">
        <button onclick="location.href='/notifications.html'">üîî</button>
        <button style="background-color: lightgrey; color: white;" onclick="location.href='/attTeacher.html'">‚úçÔ∏è</button>
        <button onclick="location.href='/gradeTeacher.html'">üíØ</button>
        <button onclick="location.href='/scheduleTeacher.html'">üìÖ</button>
        <button onclick="location.href='/support.html'">üÜò</button>
    </div>
    <h1>–£—á–µ—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</h1>

    <label for="groupPicker">–í—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É:</label>
    <select id="groupPicker"></select>

    <button id="loadAttendance">–ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</button>

    <h2>–î–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–∫ –∏ –æ—Ç–º–µ—Ç–∫–∏</h2>
    <!-- –§–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–∞—Ç—ã —É—Ä–æ–∫–∞ -->
    <form id="addLessonForm">
        <label for="lessonDate">–î–∞—Ç–∞ —É—Ä–æ–∫–∞:</label>
        <input type="date" id="lessonDate" required>
        <label for="lessonPicker">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫:</label>
        <select id="lessonPicker" required></select>
        <button type="submit">–î–æ–±–∞–≤–∏—Ç—å –¥–∞—Ç—É —É—Ä–æ–∫–∞</button>
    </form>

    <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</h2>
    <form id="editAttendanceForm">
        <label for="studentSelect">–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–∞:</label>
        <select id="studentSelect"></select>

        <label for="lessonSelect">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫:</label>
        <select id="lessonSelect"></select>

        <label for="statusSelect">–°—Ç–∞—Ç—É—Å:</label>
        <select id="statusSelect">
            <option value="+">–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª</option>
            <option value="-">–û—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª</option>
            <option value="–±">–ë–æ–ª–µ–µ—Ç</option>
            <option value="—É">–£–≤–∞–∂–∏—Ç–µ–ª—å–Ω–∞—è</option>
        </select>


        <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
    </form>

    <!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞ -->
    <h2>–£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫</h2>
    <form id="deleteLessonForm">
        <label for="deleteLessonSelect">–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:</label>
        <select id="deleteLessonSelect" required></select>

        <button type="submit">–£–¥–∞–ª–∏—Ç—å —É—Ä–æ–∫</button>
    </form>

    <h2>–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å</h2>
    <table border="1">
        <thead>
            <tr>
                <th>–¢–∞–±–ª–∏—Ü–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</th>
            </tr>
        </thead>
        <tbody id="attendanceTable"></tbody>
    </table>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const token = localStorage.getItem('authToken');

            if (!token) {
                alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
                return;
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É—Ä–æ–∫–∏
            function loadStudentsAndLessons(group) {
                fetch(`/api/teacher/attendance?group=${group}`, {
                    method: 'GET',
                    headers: { Authorization: `Bearer ${token}` }
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.attendance) {
                            const students = [];
                            const lessons = [];
                            const attendanceData = data.attendance;

                            attendanceData.forEach(item => {
                                if (!students.includes(item.student)) students.push(item.student);
                                if (!lessons.includes(item.date)) lessons.push(item.date);
                            });

                            const studentSelect = document.getElementById('studentSelect');
                            const lessonSelect = document.getElementById('lessonSelect');
                            const deleteLessonSelect = document.getElementById('deleteLessonSelect');

                            // –û—á–∏—Å—Ç–∫–∞ —Å–ø–∏—Å–∫–æ–≤ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
                            studentSelect.innerHTML = '';
                            lessonSelect.innerHTML = '';
                            deleteLessonSelect.innerHTML = '';

                            students.forEach(student => {
                                const option = document.createElement('option');
                                option.value = student;
                                option.textContent = student;
                                studentSelect.appendChild(option);
                            });

                            lessons.forEach(lesson => {
                                const option = document.createElement('option');
                                option.value = lesson;
                                option.textContent = lesson;
                                lessonSelect.appendChild(option);
                                deleteLessonSelect.appendChild(option.cloneNode(true));
                            });
                        } else {
                            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏');
                    });
            }


            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä—É–ø–ø—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ —É—Ä–æ–∫–∏
            document.getElementById('loadAttendance').addEventListener('click', function () {
                const group = document.getElementById('groupPicker').value;

                if (!group) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É');
                    return;
                }

                loadStudentsAndLessons(group);
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
            document.getElementById('editAttendanceForm').addEventListener('submit', function (event) {
                event.preventDefault();

                const student = document.getElementById('studentSelect').value;
                const lesson = document.getElementById('lessonSelect').value;
                const status = document.getElementById('statusSelect').value;

                const group = document.getElementById('groupPicker').value;

                if (!student || !lesson || !status) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–∞, —É—Ä–æ–∫ –∏ —Å—Ç–∞—Ç—É—Å');
                    return;
                }

                fetch('/api/teacher/updateAttendance', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        Authorization: `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        group,
                        student,
                        date: lesson,
                        status
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('–°—Ç–∞—Ç—É—Å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω');
                        } else {
                            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞');
                    });
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const token = localStorage.getItem('authToken'); // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ localStorage

            if (!token) {
                alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
                return;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
            function loadTeacherGroups() {
                fetch('/api/teacher/groups', {
                    method: 'GET',
                    headers: {
                        Authorization: `Bearer ${token}` // –ü–µ—Ä–µ–¥–∞–µ–º —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    }
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.groups) {
                            const groupPicker = document.getElementById('groupPicker');
                            groupPicker.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä—É–ø–ø—ã
                            data.groups.forEach(group => {
                                const option = document.createElement('option');
                                option.value = group;
                                option.textContent = group;
                                groupPicker.appendChild(option);
                            });
                        } else {
                            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥—Ä—É–ø–ø');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø');
                    });
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä—É–ø–ø—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
            loadTeacherGroups();

            // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏
            document.getElementById('loadAttendance').addEventListener('click', function () {
                const group = document.getElementById('groupPicker').value;

                if (!group) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É');
                    return;
                }

                fetch(`/api/teacher/attendance?group=${group}`, {
                    method: 'GET',
                    headers: {
                        Authorization: `Bearer ${token}` // –ü–µ—Ä–µ–¥–∞–µ–º —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ
                    }
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.attendance) {
                            const uniqueStudents = [];
                            const uniqueDates = [];
                            const attendanceData = data.attendance;

                            // –°–æ–±–∏—Ä–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞—Ç—ã
                            attendanceData.forEach(item => {
                                if (!uniqueStudents.includes(item.student)) {
                                    uniqueStudents.push(item.student);
                                }
                                if (!uniqueDates.includes(item.date)) {
                                    uniqueDates.push(item.date);
                                }
                            });

                            // –°—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É
                            const tableBody = document.getElementById('attendanceTable');
                            tableBody.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É

                            // –°—Ç—Ä–æ–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –¥–∞—Ç–∞–º–∏
                            const headerRow = document.createElement('tr');
                            headerRow.innerHTML = `<th>–°—Ç—É–¥–µ–Ω—Ç</th>`;
                            uniqueDates.forEach(date => {
                                const th = document.createElement('th');
                                th.textContent = date;
                                headerRow.appendChild(th);
                            });
                            tableBody.appendChild(headerRow);

                            // –°—Ç—Ä–æ–∏–º —Å—Ç—Ä–æ–∫–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
                            uniqueStudents.forEach(student => {
                                const row = document.createElement('tr');
                                const studentCell = document.createElement('td');
                                studentCell.textContent = student;
                                row.appendChild(studentCell);

                                uniqueDates.forEach(date => {
                                    const statusCell = document.createElement('td');
                                    const status = attendanceData.find(item => item.student === student && item.date === date)?.status || '?';
                                    statusCell.textContent = status; // –ü—Ä–æ—Å—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º —Å—Ç–∞—Ç—É—Å –±–µ–∑ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                                    row.appendChild(statusCell);
                                });

                                tableBody.appendChild(row);
                            });

                        } else {
                            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏');
                    });
            });


            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            function updateAttendanceStatus(student, date, status) {
                const group = document.getElementById('groupPicker').value;
                fetch('/api/teacher/updateAttendance', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        Authorization: `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        group,
                        student,
                        date,
                        status
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('–°—Ç–∞—Ç—É—Å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω');
                        } else {
                            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞');
                    });
            }

        });

        document.addEventListener('DOMContentLoaded', function () {
            const token = localStorage.getItem('authToken');

            if (!token) {
                alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
                return;
            }

            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–æ–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã
            function loadLessonsForGroup(group) {
                const token = localStorage.getItem('authToken');

                fetch(`/api/teacher/lessons?groupName=${group}`, {
                    method: 'GET',
                    headers: { Authorization: `Bearer ${token}` }
                })
                    .then(response => response.json())
                    .then(data => {
                        const lessonPicker = document.getElementById('lessonPicker');
                        lessonPicker.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–æ–≤—ã—Ö —É—Ä–æ–∫–æ–≤

                        if (data.lessons && data.lessons.length > 0) {
                            data.lessons.forEach(lesson => {
                                const option = document.createElement('option');
                                option.value = lesson.lesson_id;
                                option.textContent = `${lesson.day_name}: ${lesson.lesson_start} - ${lesson.lesson_end}`;
                                lessonPicker.appendChild(option);
                            });
                        } else {
                            alert('–ù–µ—Ç —É—Ä–æ–∫–æ–≤ –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É—Ä–æ–∫–æ–≤:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É—Ä–æ–∫–æ–≤');
                    });
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —É—Ä–æ–∫–∏ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –≥—Ä—É–ø–ø—ã
            document.getElementById('groupPicker').addEventListener('change', function () {
                const group = this.value;

                if (!group) {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≥—Ä—É–ø–ø—É');
                    return;
                }

                loadLessonsForGroup(group);
            });


            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä—É–ø–ø—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è
            function loadTeacherGroups() {
                fetch('/api/teacher/groups', {
                    method: 'GET',
                    headers: {
                        Authorization: `Bearer ${token}`
                    }
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.groups) {
                            const groupPicker = document.getElementById('groupPicker');
                            groupPicker.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≥—Ä—É–ø–ø—ã
                            data.groups.forEach(group => {
                                const option = document.createElement('option');
                                option.value = group;
                                option.textContent = group;
                                groupPicker.appendChild(option);
                            });
                        } else {
                            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –≥—Ä—É–ø–ø');
                        }
                    })
                    .catch(err => {
                        console.error('–û—à–∏–±–∫–∞:', err);
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –≥—Ä—É–ø–ø');
                    });
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≥—Ä—É–ø–ø—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π
            loadTeacherGroups();
        });

        document.getElementById('addLessonForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const token = localStorage.getItem('authToken');

            if (!token) {
                alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
                return;
            }

            const lessonDate = document.getElementById('lessonDate').value;
            const lessonId = document.getElementById('lessonPicker').value; // –ü–æ–ª—É—á–∞–µ–º ID —É—Ä–æ–∫–∞

            if (!lessonDate || !lessonId) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∏ —É—Ä–æ–∫');
                return;
            }

            fetch('/api/teacher/addLessonDate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    Authorization: `Bearer ${token}`
                },
                body: JSON.stringify({
                    lessonDate,
                    lessonId // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º lessonId –≤–º–µ—Å—Ç–æ groupName
                })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('–î–∞—Ç–∞ —É—Ä–æ–∫–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞');
                    } else {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–∞—Ç—ã —É—Ä–æ–∫–∞');
                    }
                })
                .catch(err => {
                    console.error('–û—à–∏–±–∫–∞:', err);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–∞—Ç—ã —É—Ä–æ–∫–∞');
                });
        });

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —É–¥–∞–ª–µ–Ω–∏—è —É—Ä–æ–∫–∞
        document.getElementById('deleteLessonForm').addEventListener('submit', function (event) {
            event.preventDefault();

            const token = localStorage.getItem('authToken');

            if (!token) {
                alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
                return;
            }

            const lessonDate = document.getElementById('deleteLessonSelect').value;

            if (!lessonDate) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è');
                return;
            }

            const group = document.getElementById('groupPicker').value;

            fetch('/api/teacher/deleteLessonDate', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    Authorization: `Bearer ${token}`
                },
                body: JSON.stringify({
                    lessonDate,
                    group
                })
            })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('–£—Ä–æ–∫ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
                        // –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –æ–±–Ω–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤
                        //loadStudentsAndLessons(group);
                    } else {
                        alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—Ä–æ–∫–∞');
                    }
                })
                .catch(err => {
                    console.error('–û—à–∏–±–∫–∞:', err);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —É—Ä–æ–∫–∞');
                });
        });

    </script>
</body>
</html>

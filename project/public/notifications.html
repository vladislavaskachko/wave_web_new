<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .notification-frame {
            border: 1px solid #2D4D8F;
            background-color: #ffffff;
            border-radius: 5px;
            padding: 10px;
            margin: 10px;
        }

        .date-label {
            color: #2D4D8F;
            font-family: Arial, sans-serif;
        }

        .notification-text {
            color: #2D4D8F;
            font-family: "Gill Sans", sans-serif;
        }

        .no-notification-label {
            color: #2D4D8F;
            font-family: "Gill Sans", sans-serif;
            text-align: center;
        }
        #notificationStack {
            margin-right: 75px; /* –∏–ª–∏ –¥—Ä—É–≥–æ–π –Ω—É–∂–Ω—ã–π –æ—Ç—Å—Ç—É–ø */
        }

        /* –ë–ª–æ–∫ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É */
        .top-right-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
        }

            .top-right-menu button {
                width: 50px;
                height: 50px;
                border: none;
                border-radius: 50%;
                background-color: #002F6C;
                color: white;
                cursor: pointer;
                font-size: 24px;
                text-align: center;
            }
    </style>
</head>
<body>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –º–µ–Ω—é -->
    <div class="top-right-menu"></div>

    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="notificationStack"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // –ß–∏—Ç–∞–µ–º —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            var userRole = localStorage.getItem('userRole');
            var menuContainer = document.querySelector('.top-right-menu');
            let menuHtml = '';
            
            if (userRole === '3') {
                // –ú–µ–Ω—é –¥–ª—è —É—á–µ–Ω–∏–∫–∞
                menuHtml = `
                    <button style="background-color: lightgrey; color: white;" onclick="location.href='/notifications.html'">üîî</button>
                    <button onclick="location.href='/attendance.html'">‚úçÔ∏è</button>
                    <button onclick="location.href='/gradeStudent.html'">üíØ</button>
                    <button onclick="location.href='/scheduleStudent.html'">üìÖ</button>
                    <button onclick="location.href='/support.html'">üÜò</button>
                `;
            } else if (userRole === '2') {
                // –ú–µ–Ω—é –¥–ª—è —É—á–∏—Ç–µ–ª—è
                menuHtml = `
                    <button style="background-color: lightgrey; color: white;" onclick="location.href='/notifications.html'">üîî</button>
                    <button onclick="location.href='/attTeacher.html'">‚úçÔ∏è</button>
                    <button onclick="location.href='/gradeTeacher.html'">üíØ</button>
                    <button onclick="location.href='/scheduleTeacher.html'">üìÖ</button>
                    <button onclick="location.href='/support.html'">üÜò</button>
                `;
            } else if (userRole === '4') {
                // –ú–µ–Ω—é –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª—è
                menuHtml = `
                    <button style="background-color: lightgrey; color: white;" onclick="location.href='/notifications.html'">üîî</button>
                    <button onclick="location.href='/attParent.html'">‚úç</button>
                    <button onclick="location.href='/gradeParent.html'">üíØ</button>
                    <button onclick="location.href='/scheduleParent.html'">üìÖ</button>
                    <button onclick="location.href='/parentPayments.html'">üí∞</button>
                    <button onclick="location.href='/support.html'">üÜò</button>
                `;
            }
            // –ï—Å–ª–∏ —Ä–æ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –º–µ–Ω—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
            else {
                menuHtml = `
                    <button onclick="location.href='/notifications.html'">üîî</button>
                    <button onclick="location.href='/support.html'">üÜò</button>
                `;
            }

            menuContainer.innerHTML = menuHtml;
        });
    </script>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å —Å–µ—Ä–≤–µ—Ä–∞
        function loadNotifications() {
            var request = new XMLHttpRequest();
            request.open('GET', 'http://localhost:1337/api/notifications', true);
            request.setRequestHeader('Content-Type', 'application/json');

            request.onload = function () {
                if (request.status >= 200 && request.status < 300) {
                    var notifications = JSON.parse(request.responseText);
                    var notificationStack = document.getElementById('notificationStack');
                    notificationStack.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

                    if (notifications.length === 0) {
                        var noNotificationLabel = document.createElement('div');
                        noNotificationLabel.classList.add('no-notification-label');
                        noNotificationLabel.textContent = '–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ—Ç';
                        notificationStack.appendChild(noNotificationLabel);
                    } else {
                        for (var i = 0; i < notifications.length; i++) {
                            var notification = notifications[i];
                            var formattedDate = new Date(notification.notification_date).toLocaleDateString('ru-RU');

                            var notificationFrame = document.createElement('div');
                            notificationFrame.classList.add('notification-frame');

                            var dateLabel = document.createElement('div');
                            dateLabel.classList.add('date-label');
                            dateLabel.textContent = formattedDate;

                            var notificationText = document.createElement('div');
                            notificationText.classList.add('notification-text');
                            notificationText.textContent = notification.notification_text;

                            notificationFrame.appendChild(dateLabel);
                            notificationFrame.appendChild(notificationText);

                            notificationStack.appendChild(notificationFrame);
                        }
                    }
                } else {
                    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π');
                }
            };

            request.onerror = function () {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –∑–∞–ø—Ä–æ—Å–∞');
            };

            request.send();
        }


        window.onload = loadNotifications;</script>

</body>
</html>